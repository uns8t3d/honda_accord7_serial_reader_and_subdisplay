#ifndef navi_subdisplay_h
#define navi_subdisplay_h

#include <Arduino.h>
#include <avr/pgmspace.h>

#define LATCH_SIZE 7
#define DATA_SIZE 6
#define SLAVE_PIN 4

const byte asciiMap[95][4] = {
  { 0, 0, 0, 0 }, // SPACE - ASCII 32
  { 0, 0, 0, 0b01000000 }, // ! (mode 2)
  { 0, 0, 0, 0 }, // "
  { 0, 0, 0b10000000, 0b01000000 }, // # (mode 4)
  { 0, 0, 0b10000000, 0 }, // $ (mode 6)
  { 0, 0, 0b10110000, 0 }, // % (mode 8)
  // { 0b10000000, 0b10000000, 0, 0b00100000 }, // & (mode man)
  { 0, 0b01010000, 0b00010000, 0 }, // & (mode man)
  { 0, 0, 0, 0 }, // '
  { 0, 0, 0, 0 }, // (
  { 0, 0, 0, 0 }, // )
  { 0b00100000, 0b01100000, 0b01100000, 0b00100000 }, // *
  { 0, 0b10110000, 0b00100000, 0 }, // +
  { 0, 0, 0, 0 }, // ,
  { 0, 0b10010000, 0, 0 }, // -
  { 0b00100000, 0b01000000, 0b01000000, 0b00100000 }, // .
  { 0, 0b01000000, 0, 0b00100000 }, // /
  { 0b11010000, 0b01000000, 0b10010000, 0b01100000 }, // 0 - ASCII 48 0,
  { 0b00010000, 0, 0b00010000, 0 }, // 1
  { 0b11000000, 0b10010000, 0b00010000, 0b01000000 }, // 2
  { 0b01010000, 0b10010000, 0b00010000, 0b01000000 }, // 3
  { 0b00010000, 0b10010000, 0b10010000, 0 }, // 4
  { 0b01010000, 0b10010000, 0b10000000, 0b01000000 }, // 5
  { 0b11010000, 0b10010000, 0b10000000, 0b01000000 }, // 6
  { 0b00010000, 0, 0b00010000, 0b01000000 }, // 7
  { 0b11010000, 0b10010000, 0b10010000, 0b01000000}, // 8
  { 0b01010000, 0b10010000, 0b10010000, 0b01000000 }, // 9 - ASCII 57
  { 0, 0b00100000, 0b00100000, 0 }, // :
  { 0, 0b00100000, 0b00100000, 0 }, // ;
  { 0, 0b01000000, 0b01000000, 0 }, // >
  { 0b01000000, 0b10010000, 0, 0 }, // =
  { 0b00100000, 0, 0, 0b00100000 }, // <
  { 0, 0, 0, 0 }, // ?
  { 0, 0, 0, 0 }, // @
  { 0b10010000, 0b10010000, 0b10010000, 0b01000000 }, // A - ASCII 65
  { 0b01010000, 0b00110000, 0b00110000, 0b01000000 }, // B
  { 0b11000000, 0, 0b10000000, 0b01000000 }, // C
  { 0b01010000, 0b00100000, 0b00110000, 0b01000000 }, // D
  { 0b11000000, 0b10010000, 0b10000000, 0b01000000 }, // E
  { 0b10000000, 0b10010000, 0b10000000, 0b01000000 }, // F
  { 0b11010000, 0b00010000, 0b10000000, 0b01000000 }, // G
  { 0b10010000, 0b10010000, 0b10010000, 0 }, // H
  { 0b01000000, 0b00100000, 0b00100000, 0b01000000 }, // I
  { 0b11010000, 0, 0b00010000, 0 }, // J
  { 0b10100000, 0b10000000, 0b10000000, 0b00100000 }, // K
  { 0b11000000, 0, 0b10000000, 0 }, // L
  { 0b10010000, 0, 0b11010000, 0b00100000 }, // M
  { 0b10110000, 0, 0b11010000, 0 }, // N
  { 0b11010000, 0, 0b10010000, 0b01000000 }, // O
  { 0b10000000, 0b10010000, 0b10010000, 0b01000000 }, // P
  { 0b11110000, 0, 0b10010000, 0b01000000 }, // Q
  { 0b10100000, 0b10010000, 0b10010000, 0b01000000 }, // R
  { 0b01010000, 0b00010000, 0b01000000, 0b01000000 }, // S
  { 0, 0b00100000, 0b00100000, 0b01000000 }, // T
  { 0b11010000, 0, 0b10010000, 0 }, // U
  { 0b10000000, 0b01000000, 0b10000000, 0b00100000 }, // V
  { 0b10110000, 0b01000000, 0b10010000, 0 }, // W
  { 0b00100000, 0b01000000, 0b01000000, 0b00100000 }, // X
  { 0, 0b00100000, 0b01000000, 0b00100000 }, // Y
  { 0b01000000, 0b01000000, 0, 0b01100000 }, // Z
  { 0b10000000, 0, 0b10000000, 0 }, // ( - ASCII 91
  { 0b00100000, 0, 0b01000000, 0 }, // '\' 0b00000000
  { 0b00010000, 0, 0b00010000, 0 }, // )
  { 0b00100000, 0b01000000, 0, 0 }, // ^
  { 0b01000000, 0, 0, 0 }, // _
  { 0, 0, 0b01000000, 0 }, // `
  { 0b10010000, 0b10010000, 0b10010000, 0b01000000 }, // A - ASCII 65
  { 0b01010000, 0b00110000, 0b00110000, 0b01000000 }, // B
  { 0b11000000, 0, 0b10000000, 0b01000000 }, // C
  { 0b01010000, 0b00100000, 0b00110000, 0b01000000 }, // D
  { 0b11000000, 0b10010000, 0b10000000, 0b01000000 }, // E
  { 0b10000000, 0b10010000, 0b10000000, 0b01000000 }, // F
  { 0b11010000, 0b00010000, 0b10000000, 0b01000000 }, // G
  { 0b10010000, 0b10010000, 0b10010000, 0 }, // H
  { 0b01000000, 0b00100000, 0b00100000, 0b01000000 }, // I
  { 0b11010000, 0, 0b00010000, 0 }, // J
  { 0b10100000, 0b10000000, 0b10000000, 0b00100000 }, // K
  { 0b11000000, 0, 0b10000000, 0 }, // L
  { 0b10010000, 0, 0b11010000, 0b00100000 }, // M
  { 0b10110000, 0, 0b11010000, 0 }, // N
  { 0b11010000, 0, 0b10010000, 0b01000000 }, // O
  { 0b10000000, 0b10010000, 0b10010000, 0b01000000 }, // P
  { 0b11110000, 0, 0b10010000, 0b01000000 }, // Q
  { 0b10100000, 0b10010000, 0b10010000, 0b01000000 }, // R
  { 0b01010000, 0b00010000, 0b01000000, 0b01000000 }, // S
  { 0, 0b00100000, 0b00100000, 0b01000000 }, // T
  { 0b11010000, 0, 0b10010000, 0 }, // U
  { 0b10000000, 0b01000000, 0b10000000, 0b00100000 }, // V
  { 0b10110000, 0b01000000, 0b10010000, 0 }, // W
  { 0b00100000, 0b01000000, 0b01000000, 0b00100000 }, // X
  { 0, 0b00100000, 0b01000000, 0b00100000 }, // Y
  { 0b01000000, 0b01000000, 0, 0b01100000 }, // Z
  { 0b10000000, 0, 0b10000000, 0 }, // ( - ASCII 123
  { 0, 0b00100000, 0b00100000, 0 }, // |
  { 0b00010000, 0, 0b00010000, 0 }, // )
  { 0, 0, 0, 0 }, // ~ - ASCII 126
};

const byte tempMap[15][2][3][5] = {
  { // Lo
    { { 0, 0b00001111, 0b00001100, 0b00000001, 0 } }, // driver temp
    { { 0, 0b11000000, 0b10000000, 0b01000000, 0 }, { 5, 0b00000001, 0b00000001, 0, 0 }, { 6, 0b10000000, 0, 0, 0 } }, // passenger temp
  },
  { // 19
    { { 0, 0b00001000, 0b00001110, 0b00000110, 0b00001100 } }, // driver temp
    { { 0, 0, 0b10000000, 0b10000000, 0b10000000 }, { 5, 0b00000001, 0b00000001, 0b00000001, 0 },  { 6, 0, 0b10000000, 0b10000000, 0 } }, // passenger temp
  },
  { // 20
    { { 0, 0b00001111, 0b00001001, 0b00000110, 0b00001101 } }, // driver temp
    { { 0, 0b11000000, 0b01000000, 0b10000000, 0b11000000 }, { 5, 0b00000001, 0b00000001, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 21
    { { 0, 0b00000011, 0b00001001, 0b00000010, 0b00001001 } }, // driver temp
    { { 0, 0b01000000, 0b01000000, 0, 0b01000000 }, { 5, 0, 0b00000001, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 22
    { { 0, 0b00001111, 0b00000101, 0b00000010, 0b00001101 } }, // driver temp
    { { 0, 0b11000000, 0b11000000, 0, 0b11000000 }, { 5, 0b00000001, 0, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 23
    { { 0, 0b00001011, 0b00001101, 0b00000010, 0b00001111 } }, // driver temp
    { { 0, 0b01000000, 0b11000000, 0, 0b11000000 }, { 5, 0b00000001, 0b00000001, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 24
    { { 0, 0b00000011, 0b00001101, 0b00000110, 0b00001001 } }, // driver temp
    { { 0, 0b01000000, 0b11000000, 0b10000000, 0b01000000 }, { 5, 0, 0b00000001, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 25
    { { 0, 0b00001011, 0b00001101, 0b00000110, 0b00000101 } }, // driver temp
    { { 0, 0b01000000, 0b11000000, 0b10000000, 0b11000000 }, { 5, 0b00000001, 0b00000001, 0, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 26
    { { 0, 0b00001111, 0b00001101, 0b00000110, 0b00000101 } }, // driver temp
    { { 0, 0b11000000, 0b11000000, 0b10000000, 0b11000000 }, { 5, 0b00000001, 0b00000001, 0, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 27
    { { 0, 0b00000011, 0b00001001, 0b00000010, 0b00001101 } }, // driver temp
    { { 0, 0b01000000, 0b01000000, 0, 0b11000000 }, { 5, 0, 0b00000001, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 28
    { { 0, 0b00001111, 0b00001101, 0b00000110, 0b00001101 } }, // driver temp
    { { 0, 0b11000000, 0b11000000, 0b10000000, 0b11000000 }, { 5, 0b00000001, 0b00000001, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 29
    { { 0, 0b00001011, 0b00001101, 0b00000110, 0b00001101 } }, // driver temp
    { { 0, 0b01000000, 0b11000000, 0b10000000, 0b11000000 }, { 5, 0b00000001, 0b00000001, 0b00000001, 0 }, { 6, 0b10000000, 0, 0b10000000, 0 } }, // passenger temp
  },
  { // 30
    { { 0, 0b0001110, 0b00001011, 0b00001110, 0b00001111 } }, // driver temp
    { { 0, 0b10000000, 0b01000000, 0b10000000, 0b11000000 }, { 5, 0b00000011, 0b00000001, 0b00000001, 0 },  { 6, 0b10000000, 0b11000000, 0b11000000, 0 } }, // passenger temp
  },  
  { // 31
    { { 0, 0b0000010, 0b00001011, 0b00001010, 0b00001011 } }, // driver temp
    { { 0, 0, 0b01000000, 0, 0b01000000 }, { 5, 0, 0b00000001, 0b00000001, 0 },  { 6, 0b10000000, 0b11000000, 0b11000000, 0 } }, // passenger temp
  },  
  { // Hi
    { { 0, 0b00000101, 0b00000011, 0b00000011, 0 } }, // driver temp
    { { 0, 0b11000000, 0b01000000, 0b01000000, 0 }, { 6, 0, 0b10000000, 0b10000000, 0 } }, // passenger temp
  },
};

const byte latchAddress[4] = { 0x01, 0x02, 0x04, 0x08 };

const byte clockDigits[10][2][4] = {
  { { 0, 0, 0, 0 }, { 0b00000110, 0b00000010, 0b00000110, 0b00000010 } },
  { { 0b00000010, 0, 0b00000010, 0 }, { 0, 0b00000010, 0b00000010, 0 }},
  { { 0, 0b00000010, 0b00000010, 0 }, { 0b00000110, 0b00000100, 0b00000010, 0b00000010 }},
  { { 0, 0, 0, 0 }, { 0b00000010, 0b00000110, 0b00000010, 0b00000010 } },
  { { 0, 0, 0, 0 }, { 0, 0b00000110, 0b00000110, 0 } },
  { { 0, 0, 0, 0 }, { 0b00000010, 0b00000110, 0b00000100, 0b00000010 } },
  { { 0, 0, 0, 0 }, { 0b00000110, 0b00000110, 0b00000100, 0b00000010 } },
  { { 0, 0, 0, 0 }, { 0, 0b00000010, 0b00000010, 0b00000010 } },
  { { 0, 0, 0, 0 }, { 0b00000110, 0b00000110, 0b00000110, 0b00000010 } },
  { { 0, 0, 0, 0 }, { 0b00000010, 0b00000110, 0b00000110, 0b00000010 } },
};

class NaviSubDisplay {
	public:
		NaviSubDisplay();
		void begin();
    void text(const char *pString);
    void render();
    void setClimatTemp(int8_t dTempIndex, int8_t pTempIndex);
    void clear();
    void clock(byte hours, byte minutes, boolean showPoints);
  private:
};

#endif
